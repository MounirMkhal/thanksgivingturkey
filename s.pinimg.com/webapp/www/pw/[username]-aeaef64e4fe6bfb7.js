(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[81337],{628387:function(e,t,r){"use strict";r.d(t,{Z:function(){return U}});var s=r(868073),o=r(297949),n=r(868808),a=r(410150),i=r(125969),l=r(282480),c=r(573706),d=r(955937),u=r(610687),_=r(476198),p=r(144326),h=r(240760),w=r(267005),f=r(677388),g=r(46807),m=r(453391),P=r(297728),y=r(882026),v=r(730212),x=r(635258),b=r(1006),j=r(901450),C=r(411399),A=r(383399),k=r(26456),z=r(758339),O=r(770443),S=function(e){var t=e.onDismiss,r=e.googleConnect,s=(0,p.ZP)();return(0,O.jsx)(z.ZP,{accessibilityModalLabel:r?s._('Successfully connect to Google', 'Accessible_label.user_connect_google_success', 'Accessible label for success message after google login'):s._('Successfully changed password', 'Accessible label for success message after password reset', 'Accessible label for success message after password reset'),footer:(0,O.jsx)(o.xu,{children:(0,O.jsx)(o.rU,{href:x.ZEf,onClick:function(e){return(0,e.dangerouslyDisableOnNavigation)()},children:(0,O.jsx)(o.zx,{color:"red",fullWidth:!0,onClick:t,text:r?s._('Log in now', 'Acknowledgement.successful_google_connect', 'Acknowledgement of successful google connect'):s._('Okay', 'Acknowledgement of successful password change', 'Acknowledgement of successful password change')})})}),heading:r?s._('Google login saved!', 'Notice.user_connect_google_success', 'Notice that a user successfully setup Google login'):s._('Password changed!', 'Notice that a user successfully changed their password', 'Notice that a user successfully changed their password'),onDismiss:t,size:"md",children:(0,O.jsx)(o.xu,{padding:4,children:!r&&(0,O.jsx)(o.xv,{children:s._('Your password has been changed successfully', 'Notice that a user successfully changed their password', 'Notice that a user successfully changed their password')})})})},T=r(415787);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach(function(t){V(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function L(e,t,r,s,o,n,a){try{var i=e[n](a),l=i.value}catch(e){r(e);return}i.done?t(l):Promise.resolve(l).then(s,o)}function q(e){return function(){var t=this,r=arguments;return new Promise(function(s,o){var n=e.apply(t,r);function a(e){L(n,s,o,a,i,"next",e)}function i(e){L(n,s,o,a,i,"throw",e)}a(void 0)})}}function F(e,t){return(F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t,r){return(t=G(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G(e){var t=function(e,t){if("object"!==E(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!==E(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===E(t)?t:String(t)}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(i,e);var t,r,s,n,a=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=N(i);return e=t?Reflect.construct(r,arguments,N(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"===E(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return Z(e)}(this,e)});function i(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i);for(var e,t,r,s=arguments.length,o=Array(s),n=0;n<s;n++)o[n]=arguments[n];return V(Z(e=a.call.apply(a,[this].concat(o))),"state",{errors:{newPassword:[],newPasswordConfirm:[]},newPassword:"",newPasswordConfirm:"",showConfirmation:!1,showGoogleButton:!1,googleConnected:!1,data:null,recaptchaV3Token:void 0}),V(Z(e),"requiredValidator",(0,k.aH)({message:e.props.i18n._('Required', 'Validation error when a required field is missing', 'Validation error when a required field is missing')})),V(Z(e),"validators",{newPassword:e.props.getPasswordValidationRules({username:e.props.options.username}),newPasswordConfirm:{required:e.requiredValidator,equalTo:function(t){return(0,k.sG)({targetValue:t,message:e.props.i18n._('Passwords don\u2018t match', ' - ', ' -- ')})}}}),V(Z(e),"handlePasswordFieldChange",(t=q(regeneratorRuntime.mark(function t(r,s){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState(V({},r,s)),t.next=3,e.validateFields(r,s);case 3:case"end":return t.stop()}},t)})),function(e,r){return t.apply(this,arguments)})),V(Z(e),"handleSubmitSuccess",function(t){t.resource_response.data.password_changed&&(e.props.logContextEvent({event_type:52,view_type:7,view_parameter:53,component:141,aux_data:{reset_password_page_version:"react"}}),e.setState({showConfirmation:!0}))}),V(Z(e),"handleSubmitFailure",function(t){var r;t.api_error_code===w.Zn?(r={showConfirmation:!0},e.props.logContextEvent({event_type:52,view_type:7,view_parameter:53,component:141,aux_data:{reset_password_page_version:"react"}})):t.api_error_code===w.QY?r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[],newPasswordConfirm:[]},data:{is_link_valid:!1}}:t.api_error_code?r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[t.message_detail||t.message],newPasswordConfirm:[]}}:((0,T.nP)("www.dWeb.passwordChange.failed",{sampleRate:1,tags:{error_message_detail:t.message_detail,error_message:t.message,api_error_code:t.api_error_code,httpStatus:t.httpStatus}}),r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[e.props.i18n._('Something went wrong. Please try again later.', 'unauth.dWeb.passwordReset.somethingWentWrong', 'Generic error message')],newPasswordConfirm:[]}}),e.setState(D({},r))}),V(Z(e),"handleSubmit",function(t){t.event.preventDefault();var r=e.state,s=r.newPassword,o=r.newPasswordConfirm,n=r.recaptchaV3Token,a=e.props.options,i=a.expiration,l=a.token,c=a.username;(0,g.Z)({expiration:i,new_password:s,new_password_confirm:o,token:l,username:c,recaptcha_v3_token:n}).then(e.handleSubmitSuccess,e.handleSubmitFailure)}),V(Z(e),"handleGoogleConnect",function(t){var r=e.props,s=r.showToastAndClose,o=r.i18n,n=r.logContextEvent,a=r.requestContext,i={success:function(){s({state:"success",message:o._('You\'re logged in with Google!', 'unauthGoogleconnect.success.toast', 'toast for unauth google connect success')}),n({event_type:15395,component:141,element:208}),(0,b.My)("unauth.dweb.password_reset.google_connect_success"),e.setState({showConfirmation:!0,googleConnected:!0})},error:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){e&&e.api_error_code===w.pH?(s({state:"error",message:o._('This account is already linked to another Pinterest user', 'unauth_google_link.already_in_use.error_toast', 'Error text on google account already in use unauth')}),n({event_type:15397,component:141,element:208,aux_data:{fail_reason:"google_dup"}}),(0,b.My)("unauth.dweb.password_reset.google_connect_duplicate")):e&&(s({state:"error",message:o._('Unable to connect to Google. Please try again', 'unauth_google_link.connection_fail.error_toast', 'Error text on google account connection failure unauth')}),n({event_type:15397,component:141,element:208,aux_data:{fail_reason:e.api_error_code}}))}),complete:function(){}};(0,g.J)({i18n:o,requestContext:a},t,i)}),V(Z(e),"validateFields",(0,d.Z)((r=q(regeneratorRuntime.mark(function t(r,s){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o={},"newPassword"!==r){t.next=9;break}return t.next=4,e.runAsyncValidators(r,s);case 4:o={newPassword:t.sent,newPasswordConfirm:e.state.newPasswordConfirm?e.runValidators("newPasswordConfirm",e.state.newPasswordConfirm,s):[]},t.next=11;break;case 9:o={newPasswordConfirm:e.runValidators("newPasswordConfirm",s,e.state.newPassword)};case 11:e.setState(function(e){return{errors:D(D({},e.errors),o)}});case 12:case"end":return t.stop()}},t)})),function(e,t){return r.apply(this,arguments)}),300)),V(Z(e),"dismissConfirmationModal",function(){return e.setState({showConfirmation:!1})}),e}return n=[{key:"componentDidMount",value:(r=q(regeneratorRuntime.mark(function e(){var t,r,s,o,n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.isUnauth){e.next=3;break}return this.setState({data:this.props.data}),e.abrupt("return");case 3:if(r=(t=this.props.options).username,s=t.token,o=t.expiration,!(this.props.currentUsername===r&&this.props.isLimitedLogin&&this.props.logout)){e.next=7;break}return e.next=7,this.props.logout({source:"password-reset"});case 7:(0,m.Z)({expiration:o,token:s,username:r}).then(function(e){var t=e.resource_response.data,r=t.is_link_valid,s=t.is_google_eligible;a.setState({data:e.resource_response.data}),(0,b.My)("unauth.dweb.password_reset.verify_link_from_email"),r&&s&&a.props.checkExperiment("unauth_google_connect_on_reset_password_page").anyEnabled?(a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:"google"}}),(0,b.My)("unauth.dweb.password_reset.google_password_version_view"),a.setState({showGoogleButton:!0})):(a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:r?"pwd":"invalid"}}),(0,b.My)("unauth.dweb.password_reset.is_link_valid.".concat(r)))}).catch(function(){a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:"error"}}),a.setState({data:{is_link_valid:!1,is_google_eligible:!1}})}),(n=function(){(0,y.rY)(function(e){return a.setState({recaptchaV3Token:e})},function(){},y.Ec)})(),setInterval(n,y.yc);case 11:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"runValidators",value:function(e,t,r){var s=this.validators[e];"newPasswordConfirm"===e&&(s=D(D({},s),{equalTo:s.equalTo(r)}));var o=Object.values(s);return(0,k.FU)(o,t)}},{key:"runAsyncValidators",value:(s=q(regeneratorRuntime.mark(function e(t,r,s){var o,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.validators[t],"newPasswordConfirm"!==t){e.next=5;break}return n=Object.values(o=D(D({},o),{equalTo:o.equalTo(s)})),e.abrupt("return",(0,k.FU)(n,r));case 5:return a=Object.values(o),e.abrupt("return",(0,k.Ks)(a,r));case 7:case"end":return e.stop()}},e,this)})),function(e,t,r){return s.apply(this,arguments)})},{key:"render",value:function(){var e=this,t=this.state,r=t.newPassword,s=t.newPasswordConfirm,n=t.errors,a=t.showGoogleButton,i=this.state.data,l=this.props,c=l.i18n,d=l.logContextEvent,_=this.props.options,p=_.expiration,w=_.token,f=_.username,g=n.newPassword.length+n.newPasswordConfirm.length;if(!i)return null;var m=i.is_link_valid;return(0,O.jsxs)(o.kC,{alignItems:"center",direction:"column",justifyContent:"center",children:[!m&&(0,O.jsxs)(o.xu,{"data-test-id":"web-reset-pass-header",display:"block",maxWidth:450,width:"58.33333%",children:[(0,O.jsx)(o.X6,{align:"center",children:c._('Sorry', 'unauth.dweb.passwordReset.sorryHeading', 'Heading when a reset password link is invalid')}),(0,O.jsx)(o.xu,{marginTop:6,children:(0,O.jsx)(o.xv,{align:"center",children:c._('The password reset link was invalid / expired (valid for 24 hrs), possibly because it has already been used.', 'unauth.dweb.passwordReset.linkInvalidtext', 'Explanation of why a user is unable to reset their password from the current link')})}),(0,O.jsx)(o.xu,{marginTop:6,children:(0,O.jsx)(o.xv,{align:"center",children:(0,h.nk)(c._('Please request a {{anchorTag}}', 'unauth.dweb.passwordReset.newResetLinkText', 'Prompt to click for new password reset email'),{anchorTag:(0,O.jsx)(o.xv,{color:"default",inline:!0,weight:"bold",children:(0,O.jsx)(o.rU,{display:"inlineBlock",href:x.lfe,underline:"hover",children:c._('new password reset', 'unauth.dweb.passwordReset.newResetLinkText.link', 'Fragment of invalid password reset link message.Prompt to request a new reset password link')},"invalidLink")})})})})]}),m&&a&&(0,O.jsx)(o.xu,{alignItems:"center",display:"flex",height:64,justifyContent:"center",marginBottom:4,width:1005,children:(0,O.jsx)(o.he,{iconAccessibilityLabel:"Info",message:c._('Choose how to get back into your account: Set up Google login, or set a password', 'resetPasswordPage.banner.text', 'text for reset password page banner'),onDismiss:function(){d({event_type:15394,component:141})},type:"info"})}),m&&(0,O.jsx)("form",{method:"POST",onSubmit:this.handleSubmit,style:{width:"100%",justifyContent:"space-around",display:"flex"},children:(0,O.jsxs)(o.xu,{"data-test-id":"web-reset-pass-header",display:"block",maxWidth:a?360:450,width:"58.33333%",children:[a?(0,O.jsxs)(o.xu,{children:[(0,O.jsx)(u.Z,{onClick:function(){return function(){(0,b.My)("unauth.dweb.password_reset.google_connect_click"),d({event_type:15392,component:141,element:208}),e.handleGoogleConnect({username:f,token:w,expiration:p})}},textOption:"accountRecovery"}),(0,O.jsx)(o.xu,{marginTop:2,paddingY:4,children:(0,O.jsxs)(o.xv,{align:"center",weight:"bold",children:[" ",c._('OR', 'divider.password_reset_page.text', 'divider text on password reset page')," "]})})]}):(0,O.jsx)(o.X6,{align:"center",children:c._('Pick a new password', 'Prompt to pick a new password', 'Prompt to pick a new password')}),(0,O.jsxs)(o.xu,{children:[(0,O.jsx)(o.xu,{marginBottom:2,marginTop:4,children:(0,O.jsx)(o.__,{htmlFor:"newPassword",children:(0,O.jsx)(o.xv,{weight:a?"normal":"bold",children:c._('New password', 'Field label for entering a new password', 'Field label for entering a new password')})})}),(0,O.jsx)(o.nv,{dataTestId:"new-password",errorMessage:Array.isArray(n.newPassword[0])?n.newPassword[0].join(""):n.newPassword[0],id:"newPassword",onChange:function(t){var r=t.value;e.handlePasswordFieldChange("newPassword",r)},size:"lg",type:"password",value:this.state.newPassword}),(0,O.jsx)(o.xu,{marginBottom:2,marginTop:4,children:(0,O.jsx)(o.__,{htmlFor:"confirmNewPassword",children:(0,O.jsx)(o.xv,{weight:a?"normal":"bold",children:c._('Type it again', 'Prompt to repeat the desired password', 'Prompt to repeat the desired password')})})}),(0,O.jsx)(o.nv,{dataTestId:"confirm-new-password",errorMessage:Array.isArray(n.newPasswordConfirm[0])?n.newPasswordConfirm[0].join(""):n.newPasswordConfirm[0],id:"confirmNewPassword",onChange:function(t){var r=t.value;e.handlePasswordFieldChange("newPasswordConfirm",r)},size:"lg",type:"password",value:this.state.newPasswordConfirm})]}),(0,O.jsx)(o.xu,{display:"flex",justifyContent:a?"center":"end",marginTop:a?6:4,children:(0,O.jsx)(o.zx,{color:"red",disabled:!(r&&s&&r===s&&!g),fullWidth:!!a,onClick:this.handleSubmit,size:a?"lg":"md",text:c._('Change Password', ' - ', ' -- '),type:"submit"})})]})}),this.state.showConfirmation&&(0,O.jsx)(S,{googleConnect:this.state.googleConnected,onDismiss:this.dismissConfirmationModal})]})}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,G(s.key),s)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(l.Component);function M(e){var t=(0,c.v)().logContextEvent,r=(0,p.ZP)(),s=(0,C.Z)(),o=(0,f.aU)(),n=(0,A.Z)(),a=n.isLimitedLogin,i=n.username,l=(0,v.B)(),d=(0,P.F)().checkExperiment,u=(0,j.F9)().showToast;return(0,O.jsx)(B,D(D({},e),{},{checkExperiment:d,currentUsername:i,getPasswordValidationRules:s,i18n:r,isLimitedLogin:a,logContextEvent:t,logout:o,requestContext:l,showToastAndClose:function(e){var t=e.state,r=e.message;u(function(e){var s=e.hideToast;return(0,O.jsx)(_.ZP,{onHide:s,text:r,type:t})})}}))}var U=function(){var e=(0,s.TH)(),t=(0,s.UO)().username,r=(0,n.mB)(e.search);return"desktop"===(0,a.ZP)()?(0,O.jsx)(o.xu,{marginTop:8,children:(0,O.jsx)(M,{options:{username:t||"",expiration:r.e,token:r.t}})}):(0,O.jsx)(i.Z,{})}},266041:function(e,t,r){(window.__PWS_LOADED_HANDLERS__=window.__PWS_LOADED_HANDLERS__||[]).push(["www/pw/[username]",function(){return r(628387).Z}])}},function(e){e.O(0,[97270,97949,15787,59656,1992,27234,59256],function(){return e(e.s=266041)}),e.O()}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/www/pw/[username]-aeaef64e4fe6bfb7.js.map